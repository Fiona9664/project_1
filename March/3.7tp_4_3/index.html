<!DOCTYPE html>
<html style="background: #ededed">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="css/swiper.min.css" />
    <link rel="stylesheet" href="css/weui.min.css" />
	<link rel="stylesheet" href="css/iconfont.css?v=1.1">
    <link rel="stylesheet" href="css/index.css?v=1.1" />
    <script type="text/javascript" src="js/swiper.min.js" ></script>
	<script type="text/javascript" src="js/weui.min.js" ></script>
    <script type="text/javascript" src="js/jquery-3.3.1.min.js" ></script>
    <script type="text/javascript" src="js/index.js?v=1.8" ></script>
	<script type="text/javascript" src="js/code.js"></script>
    <title>摄影投票活动</title>
</head>
<body style="background: #ededed">
	<!--首页-->
	<div class="page page1">
		<!--搜索框-->
		<div class="searchBox sameBox" id="searchBar">
			<form >
               	<div class="input_search">
               		<label>
               			<i class="weui-icon-search"data-search="0"></i>
               			<input type="search" placeholder="请输入编号或名称" id="search"/>
               		</label>
               	</div>
            </form>
		</div>
		<!--轮播图-->
		<div class="swiper-container">
			<div class="swiper-wrapper imgBox">
			    <div class="swiper-slide" data-img="1"><a href="javascript:;"><img src="img/img0.jpg"/></a></div>
			    <div class="swiper-slide" data-img="2"><a href="javascript:;"><img src="img/img0.jpg"/></a></div>
			    <div class="swiper-slide" data-img="3"><a href="javascript:;"><img src="img/img0.jpg"/></a></div>
			    <div class="swiper-slide" data-img="4"><a href="javascript:;"><img src="img/img0.jpg"/></a></div>
			    <div class="swiper-slide" data-img="5"><a href="javascript:;"><img src="img/img0.jpg"/></a></div>
			    <div class="swiper-slide" data-img="6"><a href="javascript:;"><img src="img/img0.jpg"/></a></div>
			</div>
		 	<!-- 分页器 -->
    		<div class="swiper-pagination"></div>
		</div>
		<!--参赛人数&投票人数&访问人数-->
		<div class="peopleBox sameBox">
			<div id="joinNum" class="numBox"><p class="barColor"><i class="iconfont icon-tianjiahuiyuan sameIcon "></i></p><p id="joinPeople">参赛人数</p><p>2,853</p></div>
			<div id="voteNum" class="numBox"><p class="barColor"><i class="iconfont icon-navicon-tptj sameIcon "></i></p><p id="votePeople">投票人数</p><p>2,853</p></div>
			<div id="visitNum" class="numBox"><p class="barColor"><i class="iconfont icon-qushi sameIcon "></i></p><p id="visitPeople">访问人数</p><p>2,853</p></div>
		</div>
		<!--截止日期-->
		<div class="overTime sameBox">
			<p>距离投票截止还有:<span id="days">0</span>天<span id="hours">0</span>小时<span id="mins">0</span>分<span id="second">0</span>秒</p>
		</div>
		<!--作品-->
		<div class="worksBox beforeBox" style="margin-bottom: 0;padding-bottom: 20px">
			<div class="weui-cells__title titleBox sameBox">
				<div>
					<p>按时间倒序排序</p>
					<!--排序按钮-->
					<div class="sortBtn">
						<a id="sortTime" class="sameSort sortColor_1" data-sort="0" data-time="0">按时间<i class="iconfont icon-052caozuo_jiangxu"></i></a>
						<a id="sortTicket" class="sameSort sortColor_0" data-sort="1">按票数</a>
					</div>
				</div>
			</div>
			<div class="works sameBox">
				<div class="inforBox">
					<div class="leftBox">
						<div class="head"><i class="iconfont icon-viphuiyuanhuangguan"></i></div>
						<div class="infor">
							<p class="name">张小明</p>
							<p class="numId">编号:2233</p>
						</div>
					</div>
					<div class="rightBox">
						<span class="allTicket"><i class="iconfont icon-paihang-shouye sameIcon barColor"></i><a  class="voteNum">2,555</a></span>
						<a class="sortColor_1 sameSort voteBtn">投票</a>
					</div>
				</div>
				<div class="worksImg"><img src="img/img0.jpg"/></div>
			</div>
			<div class="works sameBox">
				<div class="inforBox">
					<div class="leftBox">
						<div class="head"><img src="img/banner1.jpg"/></div>
						<div class="infor">
							<p class="name">张小明</p>
							<p class="numId">编号:2233</p>
						</div>
					</div>
					<div class="rightBox">
						<span class="allTicket"><i class="iconfont icon-paihang-shouye sameIcon barColor"></i><a  class="voteNum">2,540</a></span>
						<a class="sortColor_1 sameSort voteBtn">投票</a>
					</div>
				</div>
				<div class="worksImg"><img src="img/img0.jpg"/></div>
			</div>
			<div class="works sameBox">
				<div class="inforBox">
					<div class="leftBox">
						<div class="head"><i class="iconfont icon-viphuiyuanhuangguan"></i></div>
						<div class="infor">
							<p class="name">张小明</p>
							<p class="numId">编号:2233</p>
						</div>
					</div>
					<div class="rightBox">
						<span class="allTicket"><i class="iconfont icon-paihang-shouye sameIcon barColor"></i><a  class="voteNum">2,543</a></span>
						<a class="sortColor_1 sameSort voteBtn">投票</a>
					</div>
				</div>
				<div class="worksImg"><img src="img/img0.jpg"/></div>
			</div>
		</div>
		<!--右侧悬浮按钮-->
		<div class="rightBtn">
			<div id="joinBtn" class="joinBtn"><a>我要<br>参赛</a></div >
			<div id="goTopBtn" onclick="pageScroll();"><a><i class="iconfont changeICon1 icon-boshiweb_zhiding"></i><br>置顶</a></div >
		</div>
		<!--数据加载-->
		<div class="page__bd" style="display: block;">
			<div class="weui-loadmore"  id="loadmore" style="display:block ;padding: 4px 0">
				<i class="weui-loading"></i>
				<span class="weui-loadmore__tips">正在加载</span>
			</div>
			<div class="weui-loadmore weui-loadmore_line" id="noData" style="display: none;">
				<span class="weui-loadmore__tips">暂无数据</span>
			</div>
		</div>
	</div>
	<!-- 遮罩层 -->
	<div class="mask" style="display: none;"></div>
	<!-- 投票验证弹窗 -->
	<div class="dialog dialog1" style="display:none ;">
		<i class="iconfont closeBtn  icon-guanbi"></i>
		<p>请输入验证码</p>
		<form>
			<input type="text" id="code_input" class="codeInput" value="" placeholder="请输入验证码"/>
		</form>
		<div class="codeBox">
			<div id="codeBox"></div>
			<!-- 刷新验证码内容按钮 -->
			<div class="reBtn" id="reBtn">看不清，换一张</div>
		</div>
		<div id="codeSub" class="sameBtn codeSub">提交</div>
		<div class="point">每天有<a id="voteTimes">3</a>次投票机会</div>
	</div>
	<!-- 投票成功 -->
	<div class="dialog dialog2" style="display: none;">
		<i class="iconfont closeBtn  icon-guanbi"></i>
		<div class="voteStyle">
			<i class="iconfont barColor icon-yes_fill sameIcon"></i>
			<a id="timeClose">倒计时3s</a>
		</div>
	</div>
	<!--底部导航栏-->
	<div class="bottomBox sameBox">
		<ul class="bar">
			<li class="barColor"><i class="iconfont icon-zhuye sameIcon"></i><p>首页</p></li>
			<li><i class="iconfont icon-huodong sameIcon"></i><p>活动介绍</p></li>
			<li><i class="iconfont icon-wodedangxuan sameIcon"></i><p>我的作品</p></li>
		</ul>
	</div>
<script>
	//请求刷新数据
	function refresh() {
		var t = setTimeout(function () {
			//更新
			for (var i = 2; i <4; i++) {
				$('.worksBox ').append(" <div class=\"works sameBox\">\n" +
						"\t\t\t\t<div class=\"inforBox\">\n" +
						"\t\t\t\t\t<div class=\"leftBox\">\n" +
						"\t\t\t\t\t\t<div class=\"head\"><i class=\"iconfont icon-viphuiyuanhuangguan\"></i></div>\n" +
						"\t\t\t\t\t\t<div class=\"infor\">\n" +
						"\t\t\t\t\t\t\t<p class=\"name\">张小明</p>\n" +
						"\t\t\t\t\t\t\t<p class=\"numId\">编号:2233</p>\n" +
						"\t\t\t\t\t\t</div>\n" +
						"\t\t\t\t\t</div>\n" +
						"\t\t\t\t\t<div class=\"rightBox\">\n" +
						"\t\t\t\t\t\t<span class=\"allTicket\"><i class=\"iconfont icon-paihang-shouye sameIcon barColor\"></i><a class=\"voteNum\">2,543</a></span>\n" +
						"\t\t\t\t\t\t<a class=\"sortColor_1 sameSort voteBtn\">投票</a>\n" +
						"\t\t\t\t\t</div>\n" +
						"\t\t\t\t</div>\n" +
						"\t\t\t\t<div class=\"worksImg\"><img src=\"img/img0.jpg\"/></div>\n" +
						"\t\t\t</div>");
			}
			weui.loading().hide()
			clearTimeout(t)
		}, 3000);
	}
	// 投票倒计时
	function timeDown(endDateStr){
		//获取当前时间
		var nowTime=Date.now();
		//获取时间差
		var timediff=Math.round((endDateStr-nowTime)/1000);
		if(timediff>0){
			//获取还剩多少天
			var day=parseInt(timediff/3600/24);
			//获取还剩多少小时
			var hour=parseInt(timediff/3600%24);
			//获取还剩多少分钟
			var minute=parseInt(timediff/60%60);
			//获取还剩多少秒
			var second=parseInt(timediff%60);
			//输出还剩多少时间
			document.getElementById("days").innerHTML=day;
			document.getElementById("hours").innerHTML=hour;
			document.getElementById("mins").innerHTML=minute;
			document.getElementById("second").innerHTML=second;
			setTimeout(function(){
				timeDown(endDateStr)
			},1000);
		}else{
			document.getElementById("second").innerHTML="0";
			// 禁止所有投票按钮点击
			return;
		}
	}
$(function(){
	// 置顶
	function pageScroll() { $('body,html').animate( {scrollTop: 1}, 500);}
	// 投票倒计时
	var endTimes= new Date("2019-04-20 19:00:00".replace(/-/g, "/"));
	timeDown(endTimes);
	//图片轮播
	var mySwiper = new Swiper ('.swiper-container', {
		loop: true, // 循环模式选项
	    pagination: {
	      el: '.swiper-pagination',
	      clickable :true,
	    },
	    autoplay: {
	    	delay: 3000,//1秒切换一次
		},
	}) 
	//排序按钮样式
	$(".sortBtn a").click(function(){
		var sortNum = $(this).data("sort");
		var sortTime = $(this).data("time");
		if(sortNum==0){
			if(sortTime==0){
				$(".titleBox p").html("按时间正序排序");
				$("#sortTime i").addClass("icon-053caozuo_shengxu").removeClass("icon-052caozuo_jiangxu");
				$("#sortTime").data("time","1");
			}else{
				$(".titleBox p").html("按时间倒序排序");
				$("#sortTime i").removeClass("icon-053caozuo_shengxu").addClass("icon-052caozuo_jiangxu");
				$("#sortTime").data("time","0");
			}
			$("#sortTicket").removeClass("sortColor_1").addClass("sortColor_0");
			$("#sortTime").removeClass("sortColor_0").addClass("sortColor_1");
		}else{
			$(".titleBox p").html("按票数排序");
			$("#sortTicket").addClass("sortColor_1").removeClass("sortColor_0");
			$("#sortTime").addClass("sortColor_0").removeClass("sortColor_1");
		}
	})
	// 监听页面滑动 搜索样式改变
	$(document).scroll(function() {
        var scroH = $(document).scrollTop();  //滚动高度
        if(scroH >100){  //距离顶部大于100px时
			$(".searchBox").addClass("anim1");
			$(".input_search").addClass("anim2");
        }
		if(scroH < 50){//返回顶部时
			$(".searchBox").removeClass("anim1");
			$(".input_search").removeClass("anim2");
		}
    });
	//投票弹窗
	var verifyCode = new GVerify("codeBox");//验证码	;
	$(".worksBox").on("click",".voteBtn",function (e) {
		e.stopPropagation();
		var _this= $(this);
		showCode(verifyCode,_this,0);
	})

	//监听是否上下拉动刷新数据
	document.addEventListener('touchmove',function () {
		$(document).scroll(function() {
			var scrollTop = $(this).scrollTop();
			var scrollHeight = $(document).height();
			var windowHeight = $(this).height();
			if (scrollTop<=0) {
				var loading = weui.loading();
				refresh();
			}
			if (scrollTop + windowHeight == scrollHeight) {
				refresh();
			}
		})
	})
})
</script>
</body>
</html>